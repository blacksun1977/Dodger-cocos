{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\GameManager.js"],"names":["Common","require","cc","Class","extends","Component","properties","Canvas","default","type","Node","label_PlayerSpeed","Label","label_Skill_1_Name","label_Skill_1_Time","label_RotationSpeed","label_ShootSpeed","label_BulletSpeed","label_BulletLifeTime","label_Score","label_GameOverScore","Player","Turret","Block1","Block2","Block3","Block4","MainMenuUI","GuideUI","GameSetUI","GameOverUI","GameAreaUI","GameRankUI","UpdateLogUI","UseEnergyBarUI","Toggle","upRotationSpeedPrefab","Prefab","upShootSpeedPrefab","upBulletSpeedPrefab","upBulletLifeTimePrefab","upPlayerSpeedPrefab","upSkill_1_MAXPrefab","GetShieldPrefab","PointRotationSpeedPrefab","PointShootSpeedPrefab","PointBulletSpeedPrefab","PointBulletLifeTimePrefab","PointPlayerSpeedPrefab","PointSkill_1_MAXPrefab","onLoad","physicsManager","director","getPhysicsManager","enabled","GameSpeed","GamePause","CanClick","active","ChooseActiveSkill","GameInit","PlayerSpeed2UI","RotationSpeedUI","BulletScaleUI","ShootSpeedUI","BulletSpeedUI","BulletLifeTimeUI","Skill_1_On","Skill_1_Level","Skill_1_Time","Skill_1_Max","Score","ItemNum","x","y","ItemLifeTime1","ItemLifeTime2","UpdateData","SwapBadItem","UseEnergyBar","isChecked","getComponent","node","GameOver","scheduleOnce","PlayerDead","Die","GameReset","childernlist","children","i","childrenCount","destroy","string","toString","SubmitScore","GetFirendRank","start","update","dt","Skill_1_Type","ActiveSkillNum","SlowTime","tmp","Math","floor","length","EnergyBar","PlayerSpeed2","PlayerSpeed1","RotationSpeed","ShootSpeed","BulletSpeed","BulletLifeTime","BulletScale","_getARandomPositon","max","min","min_distance","max_distance","getPosition","random","_getDistance","v2","pos1","pos2","sqrt","pow","SwapGoodItem","ItemType","Itemlist","Array","HaveShield","newItem","instantiate","parent","postion","SwapItem","createPoint","point_id","pointTarget","Pointlist","newPoint","target","getChildByName","upRotationSpeed","upShootSpeed","upBulletSpeed","upBulletLifeTime","upPlayerSpeed","upSkill_1_MAX","GetShield","Skill_1_Start","Bomb","UseBomb","PlayerPowerFlash","EnergyBarFlash","num","color","PlayerPowerFlashEnd","OnPressLabel","OnPressGameGuide","Init","OnPressGameStart","OnPressGameSettingOk","Skill_2_Type","log","OnPressGameRank","testDate","Date","CC_WECHATGAME","window","wx","postMessage","messageType","MessageType","SubmitData","MAIN_MENU_NUM","Data"],"mappings":"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","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["var Common = require('GameCommon');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Canvas :{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n                            //玩家属性\r\n        label_PlayerSpeed: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n\r\n        label_Skill_1_Name: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        label_Skill_1_Time: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n                            //难度属性\r\n\r\n        label_RotationSpeed: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n\r\n        label_ShootSpeed: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n\r\n        label_BulletSpeed: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n\r\n        label_BulletLifeTime: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n\r\n                            //游戏进程\r\n        label_Score: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        label_GameOverScore: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        Player: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        Turret: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n                            //特定点位\r\n        Block1: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        Block2: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n        Block3: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n        Block4: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n                            //UI\r\n        MainMenuUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GuideUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GameSetUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        GameOverUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n        GameAreaUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n        GameRankUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n        UpdateLogUI: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }, \r\n                            //按钮\r\n        UseEnergyBarUI: {\r\n            default: null,\r\n            type: cc.Toggle,\r\n        }, \r\n\r\n                            //预构体\r\n        upRotationSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        upShootSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        upBulletSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        upBulletLifeTimePrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        upPlayerSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        upSkill_1_MAXPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        GetShieldPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n\r\n        PointRotationSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        PointShootSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        PointBulletSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        PointBulletLifeTimePrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        PointPlayerSpeedPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        PointSkill_1_MAXPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad :function() {\r\n        //开启物理引擎\r\n        this.physicsManager = cc.director.getPhysicsManager();\r\n        this.physicsManager.enabled = true;\r\n        //this.node.getComponent('DeviceMotionControl').Prepare();\r\n\r\n        this.GameSpeed = 0;\r\n        this.GamePause = true;\r\n        this.CanClick = true;\r\n        //初始化游戏参数\r\n        this.MainMenuUI.active = true;\r\n        this.GuideUI.active = false;\r\n        this.GameAreaUI.active = false;\r\n        this.GameSetUI.active = false;\r\n        this.GameOverUI.active = false;\r\n        this.GameRankUI.active = false;\r\n        this.UpdateLogUI.active = false;\r\n        //this.GameInit();\r\n\r\n    },\r\n\r\n    ChooseActiveSkill :function(){\r\n        this.GameAreaUI.active = false;\r\n        this.GameSetUI.active = true;\r\n    },\r\n\r\n    GameInit(){\r\n        this.GameAreaUI.active = true;\r\n        this.PlayerSpeed2UI = 1;\r\n\r\n        this.RotationSpeedUI = 1;\r\n        this.BulletScaleUI = 1;\r\n        this.ShootSpeedUI = 1;\r\n        this.BulletSpeedUI = 1;\r\n        this.BulletLifeTimeUI = 1;\r\n\r\n        this.Skill_1_On = false;\r\n        this.Skill_1_Level = 1;\r\n        this.Skill_1_Time = 5;\r\n        this.Skill_1_Max = 5;\r\n\r\n        this.GameSpeed = 1;\r\n        this.Score = 0;\r\n        this.ItemNum = 0;\r\n\r\n        this.Player.x = -200;\r\n        this.Player.y = 0;\r\n\r\n        this.GameSpeed = 1;\r\n        this.GamePause = false;\r\n        this.CanClick = true;\r\n\r\n        this.ItemLifeTime1 = 0;\r\n        this.ItemLifeTime2 = 10;\r\n        \r\n\r\n        this.UpdateData();\r\n        this.ItemNum++;\r\n        this.SwapBadItem();\r\n\r\n        this.UseEnergyBar = this.UseEnergyBarUI.isChecked;\r\n\r\n        this.Turret.getComponent('TurretControl').GameInit();\r\n        this.Player.getComponent('PlayerControl').GameInit();\r\n        this.node.getComponent('DeviceMotionControl').GameInit();\r\n\r\n    },\r\n\r\n    GameOver(){\r\n        this.GamePause = true;\r\n        this.scheduleOnce(function() {\r\n                    this.PlayerDead();\r\n                    }, 1);\r\n    },\r\n\r\n    PlayerDead(){\r\n        this.Player.getComponent('PlayerControl').Die();\r\n        this.scheduleOnce(function() {\r\n                    this.GameReset();\r\n                    }, 1);\r\n    },\r\n\r\n    GameReset(){\r\n        var childernlist = this.node.children;\r\n        //cc.log(this.node.childrenCount);\r\n        for(var i=0;i<this.node.childrenCount;i++){\r\n            //cc.log(childernlist[i]);\r\n            childernlist[i].destroy();\r\n        }\r\n\r\n        this.Turret.getComponent('TurretControl').GameReset();\r\n        //this.GameAreaUI.active = false;\r\n        this.GameOverUI.active = true;\r\n        this.label_GameOverScore.string='得分：'+this.Score.toString();\r\n        this.GameRankUI.active = true;\r\n        this.SubmitScore();\r\n        this.GameRankUI.getComponent('GameRankControl').GetFirendRank();\r\n    },\r\n\r\n    start () {\r\n        \r\n    },\r\n\r\n    update (dt) {\r\n        if(this.GamePause)\r\n            this.GameSpeed = 0;\r\n        else{\r\n            if(!this.Skill_1_On){\r\n                if(this.Skill_1_Time<this.Skill_1_Max){\r\n                        this.Skill_1_Time+=dt/3;\r\n                        this.UpdateData();\r\n                    }\r\n            }\r\n            if(this.Skill_1_Type == Common.ActiveSkillNum.SlowTime){\r\n                if(this.Skill_1_On){\r\n                    if (this.Skill_1_Time>0) {\r\n                        this.GameSpeed = 1/(1+this.Skill_1_Level);\r\n                        this.Skill_1_Time -=dt;\r\n                        if(this.Skill_1_Time<0)\r\n                            this.Skill_1_Time = 0;\r\n                        this.UpdateData();\r\n                    }\r\n                    else{\r\n                        this.GameSpeed = 1;\r\n                        this.Skill_1_Time = 0;\r\n                    }\r\n                         \r\n                }\r\n                else{\r\n                    this.GameSpeed = 1;\r\n                }\r\n            }\r\n        }\r\n        //cc.log(this.GameSpeed);\r\n    },\r\n\r\n    UpdateData :function(){\r\n        //更新UI数据\r\n        this.label_PlayerSpeed.string = this.PlayerSpeed2UI.toString();\r\n        this.label_RotationSpeed.string = this.RotationSpeedUI.toString();\r\n        this.label_ShootSpeed.string = this.ShootSpeedUI.toString();\r\n        this.label_BulletSpeed.string = this.BulletSpeedUI.toString();\r\n        this.label_BulletLifeTime.string = this.BulletLifeTimeUI.toString();\r\n        this.label_Score.string = this.Score.toString();\r\n        var tmp = (Math.floor(this.Skill_1_Time*10)/10).toString();\r\n        if(tmp.length<3)\r\n            tmp+='.0';\r\n        this.label_Skill_1_Time.string = tmp;\r\n\r\n        this.Player.getComponent('PlayerControl').EnergyBar.getComponent('EnergyBarControl').UpdateData(this.Skill_1_Time,this.Skill_1_Max);\r\n\r\n        //计算具体参数\r\n\r\n        this.PlayerSpeed2 = (this.PlayerSpeed2UI-1)*2+20;\r\n        this.PlayerSpeed1 = this.PlayerSpeed2;\r\n        this.RotationSpeed = 10+this.RotationSpeedUI;\r\n        this.ShootSpeed = 2*15/(15+this.ShootSpeedUI);\r\n        this.BulletSpeed = 200+2*this.BulletSpeedUI;\r\n        this.BulletLifeTime = 4+this.BulletLifeTimeUI*0.5;\r\n        this.BulletScale = 40/(40+this.BulletScaleUI)+0.2\r\n    },\r\n\r\n    _getARandomPositon :function(){\r\n        var max,min,x,y;\r\n        do{\r\n            var min_distance = 20;\r\n            var max_distance = 1000;\r\n\r\n            if(this.Score >= 0 && this.Score < 5){\r\n                min_distance = 100;\r\n                max_distance = 150;\r\n            }\r\n            if(this.Score >= 5 && this.Score < 15)\r\n                {\r\n                min_distance = 150;\r\n                max_distance = 200;\r\n            }\r\n            if(this.Score >= 15 && this.Score < 25)\r\n                {\r\n                min_distance = 200;\r\n                max_distance = 250;\r\n            }\r\n            if(this.Score >= 25 && this.Score < 35)\r\n                {\r\n                min_distance = 250;\r\n                max_distance = 300;\r\n            }\r\n            if(this.Score >= 35 && this.Score < 50)\r\n                {\r\n                min_distance = 300;\r\n                max_distance = 400;\r\n            }\r\n\r\n            max = Math.min(290,this.Player.getPosition().x+max_distance);\r\n            min = Math.max(-290,this.Player.getPosition().x-max_distance);\r\n            x = Math.random()*(max-min+1)+min;\r\n\r\n            max = Math.min(290,this.Player.getPosition().y+max_distance);\r\n            min = Math.max(-290,this.Player.getPosition().y-max_distance);\r\n            y = Math.random()*(max-min+1)+min;\r\n            //是否离4个方块太近\r\n            if(this._getDistance(cc.v2(x,y),this.Block1.getPosition())<35)\r\n                continue;\r\n            if(this._getDistance(cc.v2(x,y),this.Block2.getPosition())<35)\r\n                continue;\r\n            if(this._getDistance(cc.v2(x,y),this.Block3.getPosition())<35)\r\n                continue;\r\n            if(this._getDistance(cc.v2(x,y),this.Block4.getPosition())<35)\r\n                continue;\r\n            if(this._getDistance(cc.v2(x,y),this.Turret.getPosition())<35)\r\n                continue;\r\n            if(this._getDistance(cc.v2(x,y),this.Player.getPosition())<min_distance)\r\n                continue;\r\n            break;\r\n        }while(true);\r\n        \r\n        return cc.v2(x,y);\r\n    },\r\n\r\n    _getDistance: function(pos1, pos2)\r\n    {\r\n        return Math.sqrt(Math.pow(pos1.x - pos2.x, 2) + Math.pow(pos1.y - pos2.y, 2));\r\n    },\r\n\r\n    SwapGoodItem :function(ItemType){\r\n        var Itemlist = new Array(this.upPlayerSpeedPrefab,\r\n                                this.upSkill_1_MAXPrefab,\r\n                                this.GetShieldPrefab);\r\n        var i;\r\n        if(this.Player.getComponent('PlayerControl').HaveShield)\r\n            i = Math.floor(Math.random()*2);\r\n        else\r\n            i = Math.floor(Math.random()*3);\r\n\r\n        var newItem;\r\n        if(ItemType == null)\r\n             newItem = cc.instantiate(Itemlist[i]);\r\n         else\r\n            newItem = cc.instantiate(ItemType);\r\n\r\n        newItem.parent = this.node;\r\n        var postion= this._getARandomPositon();\r\n        newItem.x = postion.x;\r\n        newItem.y = postion.y;\r\n    },\r\n\r\n    SwapBadItem :function(){\r\n        var Itemlist = new Array(this.upRotationSpeedPrefab,\r\n                                this.upShootSpeedPrefab,\r\n                                this.upBulletSpeedPrefab,\r\n                                this.upBulletLifeTimePrefab);\r\n        var i = Math.floor(Math.random()*4);\r\n        if(this.Score<4)\r\n            i = this.Score;\r\n\r\n        var newItem = cc.instantiate(Itemlist[i]);\r\n\r\n        newItem.parent = this.node;\r\n        var postion= this._getARandomPositon();\r\n        newItem.x = postion.x;\r\n        newItem.y = postion.y;\r\n    },\r\n\r\n    SwapItem :function(){\r\n        \r\n        if(this.Score==5){\r\n            this.SwapBadItem();\r\n        }\r\n        if(this.Score==15){\r\n            this.SwapBadItem();\r\n        }\r\n        if(this.Score==30){\r\n            this.SwapBadItem();\r\n        }\r\n        if((this.Score%5)==0){\r\n            if(this.Score == 5)\r\n                this.SwapGoodItem(this.GetShieldPrefab);\r\n            else\r\n                this.SwapGoodItem();\r\n        }\r\n        else\r\n            this.SwapBadItem();\r\n    },\r\n\r\n    createPoint(point_id,pointTarget){\r\n        var Pointlist = new Array(this.PointRotationSpeedPrefab,\r\n                                this.PointShootSpeedPrefab,\r\n                                this.PointBulletSpeedPrefab,\r\n                                this.PointBulletLifeTimePrefab,\r\n                                this.PointPlayerSpeedPrefab,\r\n                                this.PointSkill_1_MAXPrefab);\r\n\r\n        var newPoint = cc.instantiate(Pointlist[point_id]);\r\n        newPoint.parent = this.Canvas;\r\n        newPoint.x = this.Player.getPosition().x;\r\n        newPoint.y = this.Player.getPosition().y;\r\n        newPoint.getComponent('PointControl').target = pointTarget.getChildByName(\"1\");\r\n    },\r\n\r\n    upRotationSpeed: function(){\r\n        this.RotationSpeedUI+=1;\r\n        this.BulletScaleUI+=1;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(0,this.label_RotationSpeed.node);\r\n    },\r\n\r\n    upShootSpeed: function(){\r\n        this.ShootSpeedUI+=1;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(1,this.label_ShootSpeed.node);\r\n    },\r\n\r\n    upBulletSpeed: function(){\r\n        this.BulletSpeedUI+=1;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(2,this.label_BulletSpeed.node);\r\n    },\r\n    upBulletLifeTime: function(){\r\n        this.BulletLifeTimeUI+=1;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(3,this.label_BulletLifeTime.node);\r\n    },\r\n\r\n    upPlayerSpeed: function(){\r\n        this.PlayerSpeed2UI+=1;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(4,this.label_PlayerSpeed.node);\r\n    },\r\n\r\n    upSkill_1_MAX: function(){\r\n        this.Skill_1_Max+=1;\r\n        this.Skill_1_Time +=5;\r\n        if(this.Skill_1_Time>this.Skill_1_Max)\r\n            this.Skill_1_Time = this.Skill_1_Max;\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n        this.createPoint(5,this.label_Skill_1_Time.node);\r\n    },\r\n\r\n    GetShield: function(){\r\n        this.Score +=1;\r\n        this.UpdateData();\r\n        this.SwapItem();\r\n    },\r\n\r\n    Skill_1_Start: function(){\r\n        if(this.GamePause)\r\n            return;\r\n        if(this.Skill_1_Type == Common.ActiveSkillNum.Bomb){\r\n            if(this.Skill_1_Time>=3){\r\n                this.Player.getComponent('PlayerControl').UseBomb();\r\n                this.Skill_1_Time-=3;\r\n                this.UpdateData();\r\n            }\r\n            else{\r\n                this.PlayerPowerFlash(3);\r\n                this.Player.getComponent('PlayerControl').EnergyBar.getComponent('EnergyBarControl').EnergyBarFlash(3);\r\n            }\r\n        }\r\n    },\r\n\r\n    PlayerPowerFlash: function(num){\r\n        if(num>0){\r\n            this.label_Skill_1_Time.node.color = new cc.color(245,62,62);\r\n            this.scheduleOnce(function() {\r\n                        this.PlayerPowerFlashEnd(num);\r\n                        }, 0.2);\r\n        }\r\n        \r\n    },\r\n\r\n    PlayerPowerFlashEnd: function(num){\r\n        this.label_Skill_1_Time.node.color = new cc.color(255,255,255);\r\n        this.scheduleOnce(function() {\r\n                    this.PlayerPowerFlash(num-1);\r\n                    }, 0.2);\r\n    },\r\n\r\n    OnPressLabel:function(type){\r\n        if(!this.CanClick)\r\n            return;\r\n        if(type == 0){\r\n            this.MainMenuUI.active = false;\r\n            this.UpdateLogUI.active = true;\r\n        }\r\n    },\r\n\r\n    OnPressGameGuide: function(){\r\n        if(!this.CanClick)\r\n            return;\r\n        this.MainMenuUI.active = false;\r\n        this.GuideUI.active = true;\r\n        this.GuideUI.getComponent('GuideUIControl').Init();\r\n    },\r\n\r\n    OnPressGameStart: function(){\r\n        if(!this.CanClick)\r\n            return;\r\n        this.MainMenuUI.active = false;\r\n        this.ChooseActiveSkill();\r\n    },\r\n\r\n    OnPressGameSettingOk: function(){\r\n        if(this.Skill_1_Type!=null&&this.Skill_2_Type!=null){\r\n            cc.log(this.Skill_1_Type);\r\n            cc.log(this.Skill_2_Type);\r\n            this.GameInit();\r\n            this.GameSetUI.active = false;\r\n        }\r\n    },\r\n\r\n    OnPressGameRank: function(){\r\n        if(!this.CanClick)\r\n            return;\r\n        this.GameRankUI.active = true;\r\n        this.SubmitScore();\r\n        this.GameRankUI.getComponent('GameRankControl').GetFirendRank();\r\n        this.CanClick = false;\r\n    },\r\n\r\n    SubmitScore: function(){\r\n        if(this.Score==null)\r\n            this.Score = 0;\r\n        var testDate = new Date();\r\n        if (CC_WECHATGAME) {\r\n            window.wx.postMessage({\r\n                messageType: Common.MessageType.SubmitData,\r\n                MAIN_MENU_NUM: \"Score\",\r\n                Data: this.Score,\r\n            });\r\n        } else {\r\n            cc.log(\"提交得分:Score:\" + this.Score);\r\n        }\r\n    },\r\n});\r\n"]}