{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\BulletControl.js"],"names":["cc","Class","extends","Component","properties","GameManager","default","type","Node","BulletSpeed","visible","GameSpeed","Angle","Enlargex","Enlargey","onLoad","find","Player","BulletLifeTime","getComponent","start","TImeOut","node","destroy","update","dt","GameSpeedNow","GamePause","Skill_1_Active","xx","getPosition","x","yy","y","distance","Math","sqrt","pow","distance_zero","distance_max","xspeed","RigidBody","linearVelocity","yspeed","atan2","cos","sin","v2","onBeginContact","contact","selfCollider","otherCollider","onEndContact","name"],"mappings":"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","file":"BulletControl.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        GameManager: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        BulletSpeed: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n        GameSpeed: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n        Angle: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n        Enlargex: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n        Enlargey: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad :function() {\r\n        this.GameManager = cc.find(\"Canvas/GameManager\");\r\n        this.Player = cc.find(\"Canvas/GameArea/Player\");\r\n        this.BulletLifeTime = this.GameManager.getComponent('GameManager').BulletLifeTime;\r\n        \r\n        this.Enlargex =false;\r\n        this.Enlargey =false;\r\n     },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    TImeOut(){\r\n        this.node.destroy();\r\n    },\r\n\r\n    update (dt) {\r\n        this.BulletLifeTime -= dt;\r\n        if(this.BulletLifeTime <=0){\r\n            this.node.destroy();\r\n        }\r\n        let GameSpeedNow = 1;\r\n        if(this.GameManager.getComponent('GameManager').GamePause)\r\n            GameSpeedNow = 0;\r\n        else\r\n        {\r\n            if(this.GameManager.getComponent('GameManager').Skill_1_Active){\r\n                let xx = this.Player.getPosition().x - this.node.x;\r\n                let yy = this.Player.getPosition().y - this.node.y;\r\n                let distance = Math.sqrt(Math.pow(xx, 2) + Math.pow(yy, 2));\r\n\r\n                let distance_zero = 1;\r\n                let distance_max = 700;\r\n                if(distance <distance_zero){\r\n                    GameSpeedNow = 0;\r\n                    this.BulletLifeTime -= dt;\r\n                }\r\n                if(distance >=  distance_zero && distance < distance_max){\r\n                    GameSpeedNow = (distance - distance_zero)/(distance_max - distance_zero);\r\n                    this.BulletLifeTime -= dt;\r\n                }\r\n                if(distance >= distance_max)\r\n                    GameSpeedNow = 1;\r\n            }\r\n            else\r\n                GameSpeedNow = 1;\r\n        }\r\n        //cc.log(1,GameSpeedNow);\r\n        if(GameSpeedNow!=this.GameSpeed){\r\n            let xspeed = this.node.getComponent(cc.RigidBody).linearVelocity.x;\r\n            let yspeed = this.node.getComponent(cc.RigidBody).linearVelocity.y;\r\n            if(GameSpeedNow == 0){\r\n                this.Angle = Math.atan2(yspeed, xspeed);\r\n                \r\n            }\r\n            if(this.GameSpeed ==0){\r\n                xspeed = Math.cos(this.Angle)*this.BulletSpeed;\r\n                yspeed = Math.sin(this.Angle)*this.BulletSpeed;\r\n            }\r\n            else{\r\n                this.Angle = Math.atan2(yspeed, xspeed);\r\n                xspeed = xspeed/this.GameSpeed;\r\n                yspeed = yspeed/this.GameSpeed;\r\n            }\r\n            xspeed *= GameSpeedNow;\r\n            yspeed *= GameSpeedNow;\r\n            this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(xspeed,yspeed);\r\n            this.GameSpeed = GameSpeedNow;\r\n        }\r\n    },\r\n\r\n    onBeginContact: function (contact, selfCollider, otherCollider) {\r\n\r\n\r\n        var xspeed = this.node.getComponent(cc.RigidBody).linearVelocity.x;\r\n        if(xspeed<33&&xspeed>=0){\r\n            xspeed +=35;\r\n            this.Enlargex = true;\r\n        }\r\n        if(xspeed>-33&&xspeed<=0){\r\n            xspeed -=35;\r\n            this.Enlargex = true;\r\n        }\r\n\r\n        var yspeed = this.node.getComponent(cc.RigidBody).linearVelocity.y;\r\n\r\n        if(yspeed<33&&yspeed>=0){\r\n            yspeed +=35;\r\n            this.Enlargey = true;\r\n        }\r\n        if(yspeed>-33&&yspeed<=0){\r\n            yspeed -=35;\r\n            this.Enlargey = true;\r\n        }\r\n\r\n        this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(xspeed,yspeed);\r\n    },\r\n\r\n    onEndContact: function (contact, selfCollider, otherCollider) {\r\n        if(otherCollider.node.name=='Player'){\r\n            this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(0,0);\r\n            return;\r\n            //this.node.color = new cc.color(255,255,255);\r\n        }\r\n        var xspeed = this.node.getComponent(cc.RigidBody).linearVelocity.x;\r\n        if(this.Enlargex){\r\n            if(xspeed>0)\r\n                xspeed-=35;\r\n            else\r\n                xspeed+=35;\r\n            this.Enlargex = false;\r\n        }\r\n        var yspeed = this.node.getComponent(cc.RigidBody).linearVelocity.y;\r\n\r\n        if(this.Enlargey){\r\n            if(yspeed>0)\r\n                yspeed-=35;\r\n            else\r\n                yspeed+=35;\r\n            this.Enlargey = false;\r\n        }\r\n\r\n        this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(xspeed,yspeed);\r\n    },\r\n});"]}