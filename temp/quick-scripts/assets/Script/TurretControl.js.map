{"version":3,"sources":["TurretControl.js"],"names":["cc","Class","extends","Component","properties","GameManager","default","type","Node","visible","BulletPrefab","Prefab","ShootTimer","BulletParent","onLoad","find","start","GameInit","x","y","parent","CreateBullet","GameReset","update","dt","getComponent","GamePause","GameSpeed","RotationSpeed","node","rotation","Skill_1_Active","newBullet","instantiate","BulletSpeed","RigidBody","linearVelocity","v2","pForAngle","Math","PI","Angle","BulletScale","scale","ShootSpeed"],"mappings":"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","file":"TurretControl.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        GameManager: {\r\n            default: null,\r\n            type: cc.Node,\r\n            visible: false,\r\n        },\r\n\r\n        BulletPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        ShootTimer: {\r\n            default: null,\r\n            visible: false,\r\n        },\r\n        BulletParent:{\r\n            default: null,\r\n            visible: false,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad :function() {\r\n        this.GameManager = cc.find(\"Canvas/GameManager\");\r\n        //this.GameInit();\r\n        this.ShootTimer = 999;\r\n    },\r\n\r\n    start () {\r\n    },\r\n\r\n    GameInit(){\r\n        this.BulletParent = new cc.Node(\"BulletParent\");\r\n        this.BulletParent.x =0;\r\n        this.BulletParent.y =0;\r\n        this.BulletParent.parent = this.GameManager;\r\n        this.BulletParent.x=0;\r\n        this.BulletParent.y=0;\r\n        this.CreateBullet();\r\n    },\r\n\r\n    GameReset :function(){\r\n        //this.BulletParent.destroy();\r\n    },\r\n\r\n    update :function(dt) {\r\n        if(!this.GameManager.getComponent('GameManager').GamePause){\r\n            let GameSpeed = this.GameManager.getComponent('GameManager').GameSpeed;\r\n\r\n            var RotationSpeed = this.GameManager.getComponent('GameManager').RotationSpeed;\r\n            RotationSpeed = RotationSpeed * GameSpeed;\r\n            this.node.rotation += dt*RotationSpeed;\r\n\r\n            if(this.GameManager.getComponent('GameManager').Skill_1_Active){\r\n                this.ShootTimer -= dt/2 * GameSpeed;\r\n            }\r\n            else\r\n                this.ShootTimer -= dt * GameSpeed;\r\n            if(this.ShootTimer<=0){\r\n                this.CreateBullet();\r\n            }\r\n        }\r\n    },\r\n\r\n    CreateBullet(){\r\n        var newBullet = cc.instantiate(this.BulletPrefab);\r\n        newBullet.x = 0;\r\n        newBullet.y = 0;\r\n        newBullet.parent = this.BulletParent;\r\n        //子弹速度\r\n        var BulletSpeed = this.GameManager.getComponent('GameManager').BulletSpeed;\r\n        newBullet.getComponent('BulletControl').BulletSpeed = BulletSpeed;\r\n\r\n        var GameSpeed = this.GameManager.getComponent('GameManager').GameSpeed;\r\n        newBullet.getComponent('BulletControl').GameSpeed = GameSpeed;\r\n\r\n        BulletSpeed = BulletSpeed * GameSpeed\r\n        newBullet.getComponent(cc.RigidBody).linearVelocity = cc.v2(cc.pForAngle(this.node.rotation*Math.PI/180).y*BulletSpeed,cc.pForAngle(this.node.rotation*Math.PI/180).x*BulletSpeed);\r\n        newBullet.getComponent('BulletControl').Angle = this.node.rotation*Math.PI/180;\r\n        \r\n\r\n        var BulletScale = this.GameManager.getComponent('GameManager').BulletScale;\r\n        newBullet.scale=cc.v2(BulletScale,BulletScale);\r\n        //发射频率\r\n        var ShootSpeed = this.GameManager.getComponent('GameManager').ShootSpeed;\r\n        this.ShootTimer = ShootSpeed;\r\n    }\r\n});"]}